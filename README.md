# Fairness of Cough Models
Evaluating demographic fairness in biometric datasets. Implementing machine learning models to predict COVID-19 test results, and then reducing bias through mitigation algorithms.

## A Guide To This Repository:
Two datasets, Coswara and CoughVID, were analyzed. Each dataset is in its respective folder given by the name of the dataset (Coswara and CoughVID). For each dataset, there are sub-folders for the analysis, figures, and results.

The Analysis folder contains the analyses for the demographic parity and equalized odds based on the results obtained for both gender and age. The .ipynb file for demographic parity contains calculations for the average selection rate before mitigation vs. after mitigation, percent improvement calculations for both the demographic parity ratio and demographic parity difference, and Student's/Welch's Two-Sample T-Tests for the demographic parity difference. The .ipynb file for equalized odds contains calculations for the average false negative rate before mitigation vs. after mitigation, percent improvement calculations for both the equalized odds ratio and the equalized odds difference, and Student's/Welch's Two-Sample T-Tests for the equalized odds difference.

The Results folder includes two .ipynb files. One .ipynb file is the code for the decision tree model (based on the parameters returned from grid search cross-validation) that is used to produce the metric values for demographic parity before and after mitigation for gender and age (this is repeated for a total of 30 iterations for gender and 30 iterations for age). The other .ipynb file contains the code that is used for the decision tree model (based on the parameters returned from grid search cross-validation) to determine the metric values for equalized odds before and after mitigation for gender and age (this is repeated for a total of 30 iterations for gender and 30 iterations for age). Furthermore, each .ipynb file generates 4 CSV files: two with the 30 iterations of the metric values (one CSV file for gender and one CSV file for age) and two with the average of each of the metric values (one CSV file for gender and one CSV file for age).

The Figures folder has the figures generated from plotting the results of the demographic parity and equalized odds mitigation algorithms for both gender and age. There are 12 figures for each dataset (3 for demographic parity for gender, 3 for demographic parity for age, 3 for equalized odds for gender, and 3 for equalized odds for age). The two .ipynb files in the folder contain the code that produces the figures for demographic parity and equalized odds.


### Coswara Dataset
As mentioned above, the Coswara dataset is divided into 3 sub-folders: Analysis, Figures, and Results. Within the Coswara folder, there is the original Coswara dataset that comes from the "coswara_data.csv" file. This file comes from a publically available repository (https://github.com/iiscleap/Coswara-Data), however, please note that in the repository the file is called "combined_data.csv". Moreover, there is a file called "Preprocessing Coswara Data.ipynb", which contains the code used to preprocess the original dataset. The preprocessed data is in this folder in a CSV file called "preprocessed_coswara_data.csv". The audio files (in .WAV format) that were used while preprocessing the original dataset are available in the repository previously mentioned (https://github.com/iiscleap/Coswara-Data). The MFCC of each of these .WAV files was extracted to use as a feature in the machine learning model(s).


### CoughVID Dataset
The CoughVID dataset is first split into 2 folders: Grid Search With CV = 10 and Grid Search With CV = 5. Grid search with the number of folds for cross-validation set to 10 was initially used for the CoughVID dataset, however, we ultimately settled on using 5 folds for cross-validation to establish a balance between bias and variance. As a result, the Grid Search With CV = 5 folder is split into 3 sub-folders: Analysis, Figures, and Results.

Within the CoughVID folder, is the original CoughVID dataset, which comes from the "virufy-cdf-coughvid.csv" file in a publically available repository (https://github.com/virufy/virufy-cdf-coughvid/tree/main). There is also a file called "Preprocessing CoughVID Data.ipynb" that includes the code for preprocessing the original dataset. The preprocessed data is available in this folder in a CSV file called "preprocessed_coughvid_data.csv". Additionally, each audio file from the original dataset was converted to a .WAV file. The MFCC of each .WAV was extracted to include it as a feature in the machine learning model(s). The .WAV files are available by request (email: pfeifer.rachel.j@gmail.com).
